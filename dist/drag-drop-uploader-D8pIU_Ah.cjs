"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),D=require("./errors-BSvFB-p5.cjs"),b=require("./field-error.vue_vue_type_script_setup_true_lang-DddrtrU-.cjs"),S=require("./index-VbWgXuT0.cjs"),M=["multiple","accept"],T={class:"drag-drop-content"},F={key:0,class:"drag-drop-prompt"},U={key:0,class:"drag-drop-help"},z={key:1,class:"file-list"},q={class:"file-info"},A={class:"file-name"},I={class:"file-size"},L={key:0,class:"file-progress"},H=["value"],P={class:"file-status"},$={key:0,class:"tag is-success is-small"},O={key:1,class:"tag is-danger is-small"},x={key:2,class:"tag is-info is-small"},R=["onClick"],j={key:1,class:"field is-grouped mt-3"},G={class:"control"},J=["disabled"],K={class:"control"},X=["disabled"],Z=e.defineComponent({__name:"drag-drop-uploader",props:{endpoint:{},accepts:{default:"*/*"},multiple:{type:Boolean,default:!0},additionalData:{},headers:{},classes:{},disabled:{type:Boolean},forLabel:{},modelValue:{type:[Boolean,Number,String,Array,Date]},placeholder:{},required:{type:Boolean},isLoading:{type:Boolean},isRounded:{type:Boolean},autocomplete:{type:Boolean},icon:{},iconType:{},iconPack:{},textIcon:{type:Boolean},leftIcon:{},iconClasses:{},leftIconClass:{},leftIconType:{},rightIconClass:{},rightIcon:{},rightIconType:{},error:{},hasAddons:{type:Boolean},isNormal:{type:Boolean},isSmall:{type:Boolean},isMedium:{type:Boolean},isLarge:{type:Boolean},isResponsive:{type:Boolean},isExpanded:{type:Boolean},isFullwidth:{type:Boolean},is0:{type:Boolean},is1:{type:Boolean},is2:{type:Boolean},is3:{type:Boolean},is4:{type:Boolean},is5:{type:Boolean},is6:{type:Boolean},is7:{type:Boolean},is8:{type:Boolean},is9:{type:Boolean},is10:{type:Boolean},is11:{type:Boolean},is12:{type:Boolean}},emits:["filesSelected","uploadProgress","uploadComplete","uploadError","allUploadsComplete"],setup(g,{emit:y}){const i=g,r=e.ref([]),p=e.ref(!1),c=e.ref(!1),m=e.ref();D._hasErrors(i);const d=y;function B(o){o.dataTransfer&&(o.dataTransfer.dropEffect="copy"),p.value=!0}function h(){p.value=!1}function v(o){var t;if(p.value=!1,(t=o.dataTransfer)!=null&&t.files){const l=Array.from(o.dataTransfer.files);f(l)}}function _(){var o;(o=m.value)==null||o.click()}function k(o){const t=o.target;if(t.files){const l=Array.from(t.files);f(l)}}function f(o){const t=o.filter(s=>!r.value.some(a=>a.name===s.name&&a.size===s.size)),l=t.map(s=>({file:s,name:s.name,size:s.size,progress:0,isUploading:!1,isComplete:!1,hasError:!1}));i.multiple?r.value.push(...l):r.value=l.slice(0,1),d("filesSelected",t)}function E(o){r.value.splice(o,1)}function C(){r.value=[]}async function V(){if(!i.endpoint)return;c.value=!0;const o=[];try{for(const t of r.value)if(!t.isComplete){t.isUploading=!0,t.hasError=!1;try{const l=await N(t);t.isComplete=!0,t.isUploading=!1,o.push(l),d("uploadComplete",{file:t.file,response:l})}catch(l){t.hasError=!0,t.isUploading=!1,t.errorMessage=l instanceof Error?l.message:"Upload failed",d("uploadError",{file:t.file,error:t.errorMessage})}}d("allUploadsComplete",o)}finally{c.value=!1}}async function N(o){return new Promise((t,l)=>{const s=new FormData;s.append("file",o.file),i.additionalData&&Object.entries(i.additionalData).forEach(([n,u])=>{s.append(n,String(u))});const a=new XMLHttpRequest;a.upload.addEventListener("progress",n=>{n.lengthComputable&&(o.progress=Math.round(n.loaded/n.total*100),d("uploadProgress",{file:o.file,progress:o.progress}))}),a.addEventListener("load",()=>{if(a.status>=200&&a.status<300)try{const n=JSON.parse(a.responseText);t(n)}catch{t(a.responseText)}else l(new Error(`HTTP ${a.status}: ${a.statusText}`))}),a.addEventListener("error",()=>{l(new Error("Network error occurred"))}),a.open("POST",i.endpoint),i.headers&&Object.entries(i.headers).forEach(([n,u])=>{a.setRequestHeader(n,u)}),a.send(s)})}function w(o){if(o===0)return"0 Bytes";const t=1024,l=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(o)/Math.log(t));return parseFloat((o/Math.pow(t,s)).toFixed(2))+" "+l[s]}return(o,t)=>{const l=e.resolveComponent("field-label");return e.openBlock(),e.createElementBlock("div",null,[o.$slots.default||o.$slots.description?(e.openBlock(),e.createBlock(l,{key:0,required:o.required},{description:e.withCtx(()=>[e.renderSlot(o.$slots,"description",{},void 0,!0)]),default:e.withCtx(()=>[e.renderSlot(o.$slots,"default",{},void 0,!0)]),_:3},8,["required"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["drag-drop-uploader",{"is-dragover":p.value,"is-uploading":c.value,"has-files":r.value.length>0}]),onDragover:e.withModifiers(B,["prevent"]),onDragleave:e.withModifiers(h,["prevent"]),onDrop:e.withModifiers(v,["prevent"]),onClick:_},[e.createElementVNode("input",{ref_key:"fileInput",ref:m,type:"file",multiple:o.multiple,accept:o.accepts,onChange:k,style:{display:"none"}},null,40,M),e.createElementVNode("div",T,[r.value.length===0?(e.openBlock(),e.createElementBlock("div",F,[t[0]||(t[0]=e.createElementVNode("svg",{class:"drag-drop-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[e.createElementVNode("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1)),t[1]||(t[1]=e.createElementVNode("p",{class:"drag-drop-text"},[e.createElementVNode("strong",null,"Click to upload"),e.createTextVNode(" or drag and drop files here ")],-1)),o.accepts?(e.openBlock(),e.createElementBlock("p",U," Accepted formats: "+e.toDisplayString(o.accepts),1)):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("div",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,(s,a)=>(e.openBlock(),e.createElementBlock("div",{key:a,class:e.normalizeClass(["file-item",{"is-uploading":s.isUploading,"is-success":s.isComplete,"is-error":s.hasError}])},[e.createElementVNode("div",q,[e.createElementVNode("span",A,e.toDisplayString(s.name),1),e.createElementVNode("span",I,e.toDisplayString(w(s.size)),1)]),s.isUploading?(e.openBlock(),e.createElementBlock("div",L,[e.createElementVNode("progress",{class:"progress is-small is-primary",value:s.progress,max:"100"},e.toDisplayString(s.progress)+"% ",9,H)])):e.createCommentVNode("",!0),e.createElementVNode("div",P,[s.isComplete?(e.openBlock(),e.createElementBlock("span",$," Complete ")):s.hasError?(e.openBlock(),e.createElementBlock("span",O," Error ")):s.isUploading?(e.openBlock(),e.createElementBlock("span",x,e.toDisplayString(s.progress)+"% ",1)):e.createCommentVNode("",!0)]),s.isUploading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:1,class:"delete is-small",onClick:e.withModifiers(n=>E(a),["stop"])},null,8,R))],2))),128))]))])],34),r.value.length>0?(e.openBlock(),e.createElementBlock("div",j,[e.createElementVNode("div",G,[e.createElementVNode("button",{class:e.normalizeClass(["button is-primary",{"is-loading":c.value}]),onClick:V,disabled:c.value||!o.endpoint}," Upload Files ",10,J)]),e.createElementVNode("div",K,[e.createElementVNode("button",{class:"button",onClick:C,disabled:c.value}," Clear All ",8,X)])])):e.createCommentVNode("",!0),e.createVNode(b._sfc_main,{error:o.error},null,8,["error"])])}}}),Q=S._export_sfc(Z,[["__scopeId","data-v-bba913da"]]);exports.default=Q;
